@model event_management_asp_project.Models.Event

@{
    ViewData["Title"] = "Manage Event";
}
<main class="main">
    <!-- Page Title -->
    <div class="page-title" data-aos="fade" style="background-image: url(https://images.unsplash.com/photo-1524234599372-a5bd0194758d?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);">
        <div class="container position-relative">
            <h1>@ViewData["Title"]</h1>
            <p>Check current event info and customize it.</p>
            <nav class="breadcrumbs">
                <ol>
                    <li><a asp-action="Index">Home</a></li>
                    <li class="current">@ViewData["Title"]</li>
                </ol>
            </nav>
        </div>
    </div>
    <!-- End Page Title -->
    <!-- Events Section -->
    <section id="events" class="events section">
        <div class="container" data-aos="fade-up" data-aos-delay="100">
            <div class="row">
                <div class="col-md-6">
                    <img src="~/assets/img/hotels-1.jpg" alt="Speaker" class="img-fluid">
                </div>
                <div class="col-md-6">
                    <div class="details">
                        <div class="d-flex justify-content-between">
                            <h2>@Model.Title</h2>
                            <a asp-action="Edit" asp-route-id="@Model.EventId" class="btn py-1 px-3 custom-btn-create d-flex align-items-center"><i class="bi bi-pen p-0 pe-2"></i><span>Edit</span></a>
                        </div>

                        <div class="social">
                            <a href=""><i class="bi bi-twitter"></i></a>
                            <a href=""><i class="bi bi-facebook"></i></a>
                            <a href=""><i class="bi bi-instagram"></i></a>
                            <a href=""><i class="bi bi-linkedin"></i></a>
                        </div>
                        <p><strong>Duration:</strong> @Model.DurationInHours hours</p>
                        <p><strong>Description:</strong><br />@Model.Description</p>
                        <p>
                            <strong>Date & Location:</strong><br />
                            <!--List of venue will go here with the reservation date-->
                            <ul>
                                <li>Venue 1</li>
                                <li>Venue 2</li>
                                <li>Venue 3</li>
                            </ul>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /Events Section -->
    <!-- Reservation Section -->
    <section id="contact" class="contact section">
        <div class="container section-title" data-aos="fade-up">
            <h2>Reservations</h2>
            <p>Checkout current reservations to venues available.</p>
        </div>

        <div class="container" data-aos="fade-up" data-aos-delay="100">
            <div class="row gy-4 mt-1 align-items-start justify-content-center">
                <!-- Button trigger modal -->
                <button type="button" class="btn py-1 px-3 custom-btn-create" data-bs-toggle="modal" data-bs-target="#createReservationModal">
                    Add new reservation
                </button>
                <!-- Modal -->
                <div class="modal fade" id="createReservationModal" tabindex="-1" aria-labelledby="createReservationModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <form asp-controller="Reservations" asp-action="Create">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="createReservationModalLabel">Add new reservation</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <partial name="PartialViews/_ReservationCreateFormFields" model="new Reservation { EventId = Model.EventId }" />
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Add</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>
                                <label asp-for="@Model.Reservations!.FirstOrDefault()!.Venue!.Name"></label>
                            </th>
                            <th>
                                <label asp-for="@Model.Reservations!.FirstOrDefault()!.Venue!.Location"></label>
                            </th>
                            <th>
                                <label asp-for="@Model.Reservations!.FirstOrDefault()!.ReservationDate"></label>
                            </th>
                            <th>
                                <label asp-for="@Model.Reservations!.FirstOrDefault()!.Venue!.Service"></label>
                            </th>
                            <th>
                                <label asp-for="@Model.Reservations!.FirstOrDefault()!.Venue!.Capacity"></label>
                            </th>

                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Reservations is null || Model.Reservations.Count()! == 0)
                        {
                            <tr>
                                <td colspan="5">
                                    No Reservations made
                                </td>
                            </tr>
                        }
                        else
                        {
                            @foreach (var item in Model.Reservations!)
                            {
                                <tr>
                                    <td>@item.Venue!.Name</td>
                                    <td>@item.Venue.Location</td>
                                    <td>@item.ReservationDate</td>
                                    <td>@item.Venue.Service</td>
                                    <td class="d-flex justify-content-between">
                                        <span>@item.Venue.Capacity</span>
                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="@("#deleteReservationModal" + item.ReservationId)">
                                            <i class="bi bi-trash text-light"></i>
                                        </button>
                                        <!-- Modal -->
                                        <div class="modal fade" id="@("deleteReservationModal" + item.ReservationId)" tabindex="-1" aria-labelledby="@("deleteReservationModal" + @item.ReservationId)" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <form asp-controller="Reservations" asp-action="Delete">
                                                        <div class="modal-header">
                                                            <h1 class="modal-title fs-5" id="@(item.ReservationId)">Delete a reservation</h1>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <p>Are you sure you want to delete this reservation</p>
                                                            <partial name="PartialViews/_ReservationDeleteFormFields" model="item"/>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                                            <button type="submit" class="btn btn-danger">Yes</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        @* <a asp-controller="Reservations" asp-action="Delete" asp-route-id="@item.ReservationId" class="btn btn-danger">
                                            <i class="bi bi-trash text-light"></i>
                                        </a> *@
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </section>
    <!-- /Reservation Section -->
    <!-- Guest Resgistration Section -->
    <section id="contact" class="contact section">
        <div class="container section-title" data-aos="fade-up">
            <h2>Add Guests</h2>
            <p>Manually add guests to your event.</p>
        </div>

        <div class="container" data-aos="fade-up" data-aos-delay="100">
            <div class="row gy-4 mt-1 align-items-start justify-content-center">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Guests is null || Model.Guests.Count() == 0)
                        {
                            <tr>
                                <td colspan="3">
                                    No guests invited
                                </td>
                            </tr>
                        }
                        else
                        {
                            @foreach (var item in Model.Guests!)
                            {
                                <tr>
                                    <td>@item.Name</td>
                                    <td>@item.Email</td>
                                    <td></td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
            <div class="row gy-4 mt-1 align-items-start justify-content-center">
                <div class="col-lg-8">
                    <!--Connnect form with the action-->
                    <form action="forms/contact.php" method="post" class="php-email-form" data-aos="fade-up" data-aos-delay="400">
                        <div class="row gy-4">

                            <div class="col-md-12">
                                <input type="text" name="name" class="form-control" placeholder="Your Name" required="">
                            </div>

                            <div class="col-md-12">
                                <input type="email" class="form-control" name="email" placeholder="Your Email" required="">
                            </div>

                            <div class="col-md-12">
                                <input type="text" class="form-control" name="subject" placeholder="Confirm Your Email" required="">
                            </div>

                            <div class="col-md-12">
                                <input type="text" class="form-control" name="subject" placeholder="Your Phone Number" required="">
                            </div>

                            <div class="col-md-12 text-center">
                                <div class="loading">Loading</div>
                                <div class="error-message"></div>
                                <div class="sent-message">Your message has been sent. Thank you!</div>

                                <button type="submit">Add Guest</button>
                            </div>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <!-- /Guest Resgistration Section -->
    <div>
        <h4>Event</h4>
        <hr />
        <div class="container">
            <div class="row">
                <div class="col">
                    Reservation
                </div>
                <div class="col">
                    Guests
                </div>
            </div>

            <div class="row">
                <div class="col">
                    @if (Model.Reservations is null || Model.Reservations.Count() == 0)
                    {
                        <p>No reservations found</p>
                    }
                    else
                    {
                        @foreach (var item in Model.Reservations!)
                        {
                            @item.Venue!.Name
                            <br>
                            @item.Venue.Capacity
                            <hr />
                        }
                    }
                </div>
                <div class="col">
                    @if (Model.Guests is null || Model.Guests.Count() == 0)
                    {
                        <p>No guests invited</p>
                    }
                    else
                    {
                        @foreach (var item in Model.Guests!)
                        {
                            @item.Name
                            <br>
                            @item.Email
                            <hr />
                        }
                    }
                </div>

            </div>
        </div>

    </div>
    <div>
        <a asp-action="Edit" asp-route-id="@Model?.EventId">Edit</a> |
        <a asp-action="Index">Back to List</a>
    </div>
</main>
<partial name="../Shared/PartialViews/_CopyrightFooterSection" />
